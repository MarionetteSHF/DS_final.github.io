<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Report</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/sandstone.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="Time.html">Trend</a>
</li>
<li>
  <a href="map.html">Map</a>
</li>
<li>
  <a href="Reasons-for-bus-delay.html">Factor</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="test_zhl.html">Exploration</a>
    </li>
    <li>
      <a href="regression.html">Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="Report.html">Report</a>
</li>
<li>
  <a href="https://github.com/MarionetteSHF/DS_final.github.io">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Report</h1>

</div>


<div id="motivation" class="section level2">
<h2>Motivation</h2>
<p>The cookies anecdote is fun but the school bus delay is a serious issue. The council of the city of New York states that every year starts with a higher rate of delays caused by major traffic because the department of education has not equipped bus companies or drivers with information early enough for drivers to familiarize themselves with their route and map out their timing. Also, it is unconscionable that year after year, the Department of Education’s insufficient planning is exacerbating the stress felt by families starting a new school year. We were interested in exploring factors that cause school bus delay and understand the major reason behind bus delay. Distribution of bus delay is also what we want to figure out.</p>
<div class="figure" style="text-align: center">
<img src="image/1.png" alt="NYC BUS DELAY" width="50%" />
<p class="caption">
NYC BUS DELAY
</p>
</div>
</div>
<div id="related-work" class="section level2">
<h2>Related Work</h2>
<p>According to an analysis by <a href="https://ny.chalkbeat.org/2021/9/13/22672760/school-buses-leave-nyc-students-stranded-on-first-day">Chalkbeat in partnership with the CITY</a>, busing complaints have grown in recent years. In 2019, there were an average of 500 delays a day during the first weeks of school, which was up 5% from a year before.We realized that school bus delay is a serious issue after reading their work.</p>
<div class="figure" style="text-align: center">
<img src="image/3.jpg" alt="SCHOOL BUS DELAY" width="50%" />
<p class="caption">
SCHOOL BUS DELAY
</p>
</div>
</div>
<div id="data" class="section level2">
<h2>Data</h2>
<p>In this project, there are three primary datasets, including <code>school bus breakdown and delay</code>, <code>weather data</code>, and <code>opt code</code>. The dataset of school bus breakdown and delay was obtained from <a href="https://data.cityofnewyork.us/Transportation/Bus-Breakdown-and-Delays/ez4e-fazm">NYC open data</a>. The weather data was gained from <a href="https://www.ncei.noaa.gov/metadata/geoportal/rest/metadata/item/gov.noaa.ncdc:C00861/html">NOAA</a>. The opt code was collected from <a href="https://data.world/city-of-ny/8wau-idzf/workspace/file?filename=prek-vendors-by-transportation-site-1.csv">data.world</a>. On the one hand, for the dataset of school bus breakdown and delay, to focus on the situation of school bus delay in Manhattan under the pandemic, the data of school bus delays in Manhattan generated during 2020-2021 need to be included. On the other hand, it is unavoidable to consider the complexity of the computer processing power in this circumstance. Then, the school bus delay data from January 1, 2018 to September 30, 2021 were selected. Since weather is one of the reasons which causes school bus delays, we combine the daily weather dataset from NOAA with school bus delay dataset. Since we can only know the opt code of schools in dataset of school bus delay, we combine a opt code dataset to gather the information about the names and addresses of schools.</p>
<div id="school-bus-breakdown-and-delay" class="section level5">
<h5>School bus breakdown and delay:</h5>
<p>The dataset contains all the school bus breakdowns and delays happened in NYC. Each row represents a unique school bus breakdown or delay. The information about how long the school bus delays took, when the event happened, why the event happened, where the event happened, the number of students on the bus, school served, and the bus number can be found in the database. The key variables we used include:</p>
<p><code>School_Year</code>: the academic years including <code>2018-2019</code>, <code>2019-2020</code>, <code>2020-2021</code>. <code>Reason</code>: the reason caused the school bus breakdown or delay. <code>Schools_Serviced</code>: the school that the corresponding bus served. <code>Ocurred_On</code>: The accurate time that school bus delay or breakdown happened. <code>Boro</code>: the boro where the case happened. <code>How_Long_Delayed</code>: how long the delay was.</p>
</div>
<div id="weather-data-noaa" class="section level5">
<h5>Weather data (NOAA):</h5>
<p>Weather is one of the reasons which caused the school bus delay. To have a deeper analysis about this, it is necessary to consider the weather of the day. Since the difference of weather in Manhattan is not large, we used the weather data of Central Park in NYC to represent the weather of Manhattan. Thus, we selected several important variables in the weather dataset to joint. The key variables we used:</p>
<p><code>prcp</code>: precipitation (tenths of mm) <code>snow</code>: snowfall (mm) <code>snwd</code>: snow depth (mm) <code>tmax</code>: maximum temperature (tenths of degrees C) <code>tmin</code>: Minimum temperature (tenth of degrees C)</p>
</div>
<div id="opt-code" class="section level5">
<h5>OPT code:</h5>
<p>In school bus breakdown and delay data frame, we can see the school serviced variable, but it actually just provides the OPT code instead of the concrete names and addresses. Thus, we collected OPT code list of NYC from Data World. The key variable we used:</p>
<p><code>OPT_Code</code>: OPT code. <code>Name</code>: School names. <code>Longitude</code>: Longitude on the map <code>Latitude</code>: Latitude on the map</p>
<p>To further figure out whether there is any specific distribution or relationship, we converted the date and added the variables month and weekday in the process of cleaning data.</p>
<p><code>Month</code>: months (January to December) <code>Weekday</code>: weekdays (Monday to Sunday)</p>
<div class="figure" style="text-align: center">
<img src="image/4.webp" alt="TRAFFIC JAM" width="50%" />
<p class="caption">
TRAFFIC JAM
</p>
</div>
</div>
</div>
<div id="mapping" class="section level2">
<h2>Mapping</h2>
<p>We considered the geolocation of schools in New York city from 2015 to 2019. Compared with other areas, schools in Manhattan have more delays in school buses, and the time of delays are longer. Therefore our project is mainly for schools in Manhattan. Data in these geolocation and density heatmap plots helped identify certain neighborhoods in Manhattan that appear to have more and longer delays and they include East Harlem and Lower East Side, as well as the Hudson Yards.</p>
</div>
<div id="delay-trend-of-school-bus" class="section level2">
<h2>Delay Trend of School Bus</h2>
<p>The trend part serves to provide an overview of school bus delays in Manhattan from the Fall of 2018 to the present. As the result of the spread of Covid-19, it is unavoidable to contain the influence of Covid-19 in the analysis. Due to the fluctuating pandemic caused by Covid-19, the difference between the data before the outbreak of Covid-19 and the data after the outbreak of Covid-19 can provide us more enlightenment to estimate the trend of school bus delay circumstance in the future several years. In this part, 5 plots are shown. Each academic year starts from September and ends in June. In the general year, school buses are more likely to delay in the fall semester than the spring semesters, especially during December and January. This may be caused by extreme weather in the winter and the heavy traffic during holiday seasons. Due to the Covid-19, the counts of school bus delays decrease in the current two years. Before the pandemic (2018-2020), we can see that the school buses are more likely to delay in the fall semester than the spring semesters, especially during December and January. From the beginning of fall 2021, schools have switched back to in-person mode with the effort of vaccine enforcement and all other precautions taken, the school bus delay has a similar distribution as the pre-pandemic distribution. If we look closer at the counts of school bus delays each month. In the second plot, a comparison of the school years over 2018 to 2021 is conducted. There is a similar trend for school bus delay distribution from January to December and school bus delay is more frequent in the winter from November to the February in next year.</p>
<p>The types of school bus delays are divided into 5 categories including <code>0-15 Min</code>, <code>16-30 Min</code>, <code>31-45 Min</code>, <code>46-60 Min</code>, and <code>61-90 Min</code>. In the plot of the distribution of school bus delay time in Manhattan, we conclude that <code>31-45 Min</code> and <code>46-60 Min</code> are the two most frequent. And <code>16-30 Min</code> always took the third place no matter before the pandemic or after the pandemic. Thus, if you meet a school bus delay, you could expect the delay will probably take 15 to 60 minutes. After the outbreak of Covid-19, even though the frequency of school bus delay has decreased drastically, the annual proportion of 46-60-min delay increases, which is an interesting trend.</p>
<p>We were also curious about whether there existed a monthly rule or a specific trend for each type of school bus delay. According to the plot of monthly distribution of the five different types of school bus delays, 31-45-minute school bus delays and 46-60-minute school bus delays make up the majority part of the total number of school bus delays. For all kinds of school bus delays in the three academic years, the number of delays increases from September to October for all the three academic years. Then, after October, the number of school bus delays decreased first and then kept fluctuating for all types of school bus delays. All kinds of school bus delays will reach the second peak in either January or February. The 0-15-minute delay, 16-30-minute delay, and 31-45-minute delay are more frequent than usual in May. 31-45-minute delay and 46-60-minute delay are more frequent than usual in March. Thus, October, January, February, March, and May are more probable to encounter school bus delays than else months in a year.</p>
<p>Furthermore, is there any rule of specific trend related to bus delay in each week? Which weekday will be more probable to encounter a bus delay? Is that possible for students to estimate how long school bus delay will be basically based on weekdays? And generally, how long will the delay be? According to the plot of the weekly distribution of the five different types of school bus delay, there isn’t any specific trend about that. Encountering a school bus delay is almost equivalently probable in each school day. There isn’t a significant fluctuating trend with each academic year. In 2018-2019 academic year and 2019-2020 academic year, the three most frequent types of school bus delays are 31-45 minutes, 46-60 minutes, and 16-30 minutes in turn. In 2020-2021 academic year, the three most frequent types of school bus delays are 46-60 minutes, 31-45 minutes, and 16-30 minutes in turn.</p>
</div>
<div id="contributing-factors" class="section level2">
<h2>Contributing Factors</h2>
<p>The goal of the contributing factor analyses is to understand the major reasons that lead to the bus delay in Manhattan across three consecutive school years (2018-2019,2019-2020, and 2020-2021). We hypothesized that the heavy traffic and weather conditions may result in the most delay. We first compared the top contributing factors of bus delay in each year. From the bar graph, it is not difficult to find that heavy traffic is the most important reason resulting in bus delay and it is considered as the common factor with high frequency. The top three reasons for bus delay are heavy traffic, a mechanical problem and others. In the stacked bar graph, it is interesting to see that the number of delays per year is decreasing. We suspect that the potential reason for the reduction in delays is due to the COVID-19 and the quarantine policy associated with COVID. Because the difference of frequency between factors is quite large, we decide to show the proportion of each reason based on total delay within three years. Based on the pie chart, we notice that roughly 90% of bus delay is due to heavy traffic and 5.35 % of delay is due to a mechanical problem, and approximately 4% of delay is due to others. This result is roughly the same across three years.</p>
<p>Furthermore, we want to examine the possible relationship between heavy traffic and rainfall as well as between heavy traffic and snow depth. We combine our data with the NOAA dataset from the P8105 website and extract the precipitation and snow depth value from the dataset. We exclude the cases when there is no snow depth and rainfall in the graph we design. According to the scatter plot, more traffic occurred when rainfall is roughly below 100mm, which will be either light rain or moderate rain. We did not see any association between heavy rain and the amount of precipitation. The year 2020-2021 have less rainfall and fewer cases of bus delay compared to other years. We also study the association between heavy traffic and snow depth. Due to the lack of variability of snow depth in 2019-2020, we are unable to do the comparison across years. However, there is a negative association between snow depth and delays because of heavy traffic in 2018-2019; and no association between snow depth and delay is shown in 2020-2021. Since the weather differs from year and year and the data we obtain is not sufficient enough, we can further investigate the issue with a larger dataset.</p>
<p>Finally, we examine the relationship between weekdays and heavy traffic. We calculate the average delay due to heavy traffic per weekday across three years. We observe that heavy traffic happens frequently on Thursday and less frequently on Monday. In the school year 2020-2021, it is almost equally likely to have a similar number of delays on school days.</p>
</div>
<div id="data-analysis" class="section level2">
<h2>Data Analysis</h2>
<div id="data-explortary" class="section level3">
<h3>Data Explortary</h3>
<p>To have some statistical understanding of our data, we decided to take a step further before moving on to modeling.</p>
<p>While looking at the reason of school bus delays, we see that heavy traffic is the main reason and all other reasons plays a minor part. This lead us to ask the question, whether the distribution of school bus delay reasons is the same across 2018-2021 school years.Though we include data in 2021-2022 Fall, yet the counts isn’t comparable with other school years. So we only look at the 3 school years including, 2018-2019, 2019-2020, 2020-2021.To answer our question, we conducted a chi-square test. From the test result,we conclude that the reasons of delay have a different distribution across the school years though they seem about the same in our bar plots. Our guess is that although the leading reason remains to be heavy traffic, the percentage of heavy traffic being the reason is actually decreasing over the years.Given that the distribution of delay reasons varies from year to year, we decide to look at the nearest pre-pandemic school year. The reason we focus on 2019-2020 school year is that we assume the post pandemic situation should be similar with the nearest pre pandemic situation.</p>
<p>Looking at the plot in the distribution of delay reasons,we believe that the frequency of different reasons should not be the same. And now we want to verify our assumption using a chi-square test.From the result, we have enough evidence to say that the frequency of delay reasons are not equally distributed in 2019-2020 school year.</p>
<p>we also noticed that the delay counts varies among each month. We can see from the yearly distribution plot of school bus delays we see that winter time tend to have more delays, thus, we propose hypothesis that there is no homogeneity in delay counts in each months. According to the chi-square test result we conclude that there’s no difference of delay counts between months. The counter-intuitive result may be caused by the lock down during April to May of 2020.We don’t have any information on these 2 month therefore we are only testing the “winter month”.</p>
<p>We know there’s no difference of delay counts between months in 2019-2020. But what about different weekdays? I remembered that I was always late for school on Monday. Is it my personal problem? Maybe because of more school bus delays on Monday? To find out the real reason,we use Chi-squared test to see whether there is homogeneity in delay counts for each weekday. According to the chi-square test result we conclude that there’s no statistically difference among weekdays at 0.05 significant level. Unfortunately, there is homogeneity in the delay counts for each weekday. It seems that the reason I was always late on Monday was I still missed my weekend.</p>
</div>
<div id="modeling" class="section level3">
<h3>Modeling</h3>
<p>From previously data exploration and data analysis, we know that there exists some interesting relationship between bus delay and weather,location, and a variety of reasons.Here, we want to explore the data set deeper to predict the number of daily delay in Manhattan as our outcome and month, weekday, daily precipitation,daily snow depth,and minimum temperature as predictors.We propose 3 models for prediction:</p>
<p> 1. Linear Model of daily_delay ~ month + day + snwd + tmin</p>
<p> 2. Linear Model of daily_delay ~ month + day + snwd + tmin+ tmin*day,assuming that there are interaction</p>
<p> 3. Linear Model of daily_delay ~ month + day + prcp</p>
<p>We performed cross validation using these 3 models and model3 gives us a relatively low rmse . So we concluded that, to predict how many school bus delay may occur Manhattan in one day, we would use month,rainfall,snow depth, and weekday as predictors .</p>
<p>#Contributors: Paulina Han, Guiqi Cai, Qixiang Chen, Huili Zheng, and Hanfu Shi</p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
